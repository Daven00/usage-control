<Policy
    xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="tryAccessMany20" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable" Version="3.0" >
    <Description >Policy to be used in the use case with two attributes</Description>
    <Target ></Target>
    <Rule Effect="Permit" RuleId="rule-permit" >
        <Target >
            <AnyOf >
                <AllOf >
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal" >
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string" >read</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true" ></AttributeDesignator>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <!-- Pre condition -->
        <Condition DecisionTime="pre" >
            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and" >
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string" >IIT</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light2" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light3" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light4" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light5" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light6" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light7" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light8" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light9" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light10" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light11" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light12" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light13" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light14" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light15" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light16" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light17" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light18" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:3.0:environment:light19" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer" >1</AttributeValue>
                </Apply>
            </Apply>
        </Condition>
        <!-- On going condition -->
        <Condition DecisionTime="ongoing" >
            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and" >
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string" >IIT</AttributeValue>
                </Apply>
            </Apply>
        </Condition>
        <!-- Post condition -->
        <Condition DecisionTime="post" >
            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and" >
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal" >
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only" >
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true" ></AttributeDesignator>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string" >IIT</AttributeValue>
                </Apply>
            </Apply>
        </Condition>
    </Rule>
    <!-- Default rule -->
    <Rule Effect="Deny" RuleId="urn:oasis:names:tc:xacml:3.0:defdeny" >
        <Description >DefaultDeny</Description>
        <Target ></Target>
    </Rule>
</Policy>
